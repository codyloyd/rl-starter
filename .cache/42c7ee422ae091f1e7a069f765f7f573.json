{"dependencies":[{"name":"/Users/cloyd/coderrr/rl-starter/package.json","includedInParent":true,"mtime":1518794331000},{"name":"rot-js","loc":{"line":1,"column":16}},{"name":"../colors","loc":{"line":2,"column":19}},{"name":"../entity/entity","loc":{"line":3,"column":19}},{"name":"./gameOverScreen","loc":{"line":4,"column":27}},{"name":"./itemListDialog","loc":{"line":5,"column":27}},{"name":"../entity/entities","loc":{"line":6,"column":48}},{"name":"../level","loc":{"line":7,"column":18}},{"name":"../sounds/sounds","loc":{"line":8,"column":21}}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var e=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,i=!1,l=void 0;try{for(var s,n=e[Symbol.iterator]();!(a=(s=n.next()).done)&&(r.push(s.value),!t||r.length!==t);a=!0);}catch(e){i=!0,l=e}finally{try{!a&&n.return&&n.return()}finally{if(i)throw l}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),t=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),r=require(\"rot-js\"),a=p(r),i=require(\"../colors\"),l=p(i),s=require(\"../entity/entity\"),n=p(s),u=require(\"./gameOverScreen\"),o=p(u),d=require(\"./itemListDialog\"),h=p(d),y=require(\"../entity/entities\"),g=require(\"../level\"),c=p(g),f=require(\"../sounds/sounds\");function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}var m=function(){function r(e){v(this,r),this.game=e,this.level=new c.default(this.game),this.map=this.level.getMap(),this.subscreen=null,this.player=new n.default(Object.assign(y.PlayerTemplate,{map:this.map,Game:this.game}));var t=this.level.getRandomFloorPosition();this.player.setPosition(t.x,t.y),this.game.getScheduler().add(this.player,!0),this.game.getEngine().start(),console.log(\"enter play screen\")}return t(r,[{key:\"exit\",value:function(){console.log(\"exit play screen\")}},{key:\"handleInput\",value:function(e){if(this.subscreen)this.subscreen.handleInput(e);else{e.keyCode===a.default.VK_ESCAPE&&this.game.switchScreen(o.default);var t=function(e,t){this.player.tryMove(this.player.getX()+e,this.player.getY()+t,this.level),this.game.getEngine().unlock()}.bind(this);e.keyCode===a.default.VK_H||e.keyCode==a.default.VK_4||e.keyCode==a.default.VK_LEFT?t(-1,0):e.keyCode===a.default.VK_L||e.keyCode==a.default.VK_6||e.keyCode==a.default.VK_RIGHT?t(1,0):e.keyCode===a.default.VK_K||e.keyCode==a.default.VK_8||e.keyCode==a.default.VK_UP?t(0,-1):e.keyCode===a.default.VK_J||e.keyCode==a.default.VK_2||e.keyCode==a.default.VK_DOWN?t(0,1):e.keyCode===a.default.VK_Y||e.keyCode==a.default.VK_7?t(-1,-1):e.keyCode===a.default.VK_U||e.keyCode==a.default.VK_9?t(1,-1):e.keyCode===a.default.VK_B||e.keyCode==a.default.VK_1?t(-1,1):e.keyCode!==a.default.VK_N&&e.keyCode!=a.default.VK_3||t(1,1),e.keyCode==a.default.VK_I&&this.enterSubscreen(new h.default(this.player.inventory,this))}}},{key:\"enterSubscreen\",value:function(e){this.subscreen=e,this.game.refresh()}},{key:\"exitSubscreen\",value:function(){this.subscreen=null,this.game.refresh()}},{key:\"render\",value:function(t){var r=t.playerStatusDisplay,i=t.getDisplay(),s=this.level.getMap();r.render({name:this.player.name,hp:40,maxHp:40});var n=this.level.getItems();if(n[this.player.getX()+\",\"+this.player.getY()]){var u=n[this.player.getX()+\",\"+this.player.getY()];this.player.addItem(u)?(this.level.removeItem(u),this.game.messageDisplay.add(\"you pick up \"+u.describeA()),console.log(\"you pick up \"+u.describeA()),f.blip.play()):(this.game.messageDisplay.add(\"you see \"+u.describeA()),console.log(\"you see \"+u.describeA()))}var o=t.getScreenWidth(),d=t.getScreenHeight(),h=Math.max(0,this.player.getX()-o/2);h=Math.min(h,this.level.width-o);var y=Math.max(0,this.player.getY()-d/2);y=Math.min(y,this.level.height-d);var g=new a.default.FOV.PreciseShadowcasting(function(e,t){return!!s.getTile(e,t)&&!s.getTile(e,t).blocksLight}),c={},p=this.level.exploredTiles;g.compute(this.player.getX(),this.player.getY(),10,function(e,t,r,a){c[e+\",\"+t]=!0,p[e+\",\"+t]=!0});for(var v=h;v<h+o;v++)for(var m=y;m<y+d;m++){var k=s.getTile(v,m);c[v+\",\"+m]?i.draw(v-h,m-y,k.getChar(),k.getFg(),k.getBg()):this.level.exploredTiles[v+\",\"+m]&&i.draw(v-h,m-y,k.getChar(),l.default.darkBlue,l.default.black)}Object.keys(n).forEach(function(t){var r=t.split(\",\"),a=e(r,2),l=a[0],s=a[1],u=n[t];c[l+\",\"+s]&&i.draw(parseInt(l)-h,parseInt(s)-y,u.getChar(),u.getFg(),u.getBg())});var b=this.level.getEntities();Object.values(b).forEach(function(e){c[e.getX()+\",\"+e.getY()]&&i.draw(e.getX()-h,e.getY()-y,e.getChar(),e.getFg(),e.getBg())}),i.draw(this.player.getX()-h,this.player.getY()-y,this.player.getChar(),this.player.getFg(),this.player.getBg()),this.subscreen&&this.subscreen.render(t)}}]),r}();exports.default=m;"},"hash":"8563faf0f2fdf575409f5a7cd74674f6","cacheData":{"env":{}}}