{"dependencies":[{"name":"/Users/cloyd/coderrr/rl-starter/package.json","includedInParent":true,"mtime":1518794331000},{"name":"rot-js","loc":{"line":1,"column":16}},{"name":"../colors","loc":{"line":2,"column":19}},{"name":"../entity/entity","loc":{"line":3,"column":19}},{"name":"./gameOverScreen","loc":{"line":4,"column":27}},{"name":"./itemListDialog","loc":{"line":5,"column":27}},{"name":"../entity/entities","loc":{"line":6,"column":48}},{"name":"../level","loc":{"line":7,"column":18}}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var e=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,i=!1,l=void 0;try{for(var n,s=e[Symbol.iterator]();!(a=(n=s.next()).done)&&(r.push(n.value),!t||r.length!==t);a=!0);}catch(e){i=!0,l=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw l}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),t=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),r=require(\"rot-js\"),a=f(r),i=require(\"../colors\"),l=f(i),n=require(\"../entity/entity\"),s=f(n),u=require(\"./gameOverScreen\"),o=f(u),d=require(\"./itemListDialog\"),h=f(d),y=require(\"../entity/entities\"),g=require(\"../level\"),c=f(g);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}var v=function(){function r(e){p(this,r),this.game=e,this.level=new c.default(this.game),this.map=this.level.getMap(),this.subscreen=null,this.player=new s.default(Object.assign(y.PlayerTemplate,{map:this.map,Game:this.game}));var t=this.level.getRandomFloorPosition();this.player.setPosition(t.x,t.y),this.game.getScheduler().add(this.player,!0),this.game.getEngine().start(),console.log(\"enter play screen\")}return t(r,[{key:\"exit\",value:function(){console.log(\"exit play screen\")}},{key:\"handleInput\",value:function(e){if(this.subscreen)this.subscreen.handleInput(e);else{e.keyCode===a.default.VK_ESCAPE&&this.game.switchScreen(o.default);var t=function(e,t){this.player.tryMove(this.player.getX()+e,this.player.getY()+t,this.level),this.game.getEngine().unlock()}.bind(this);e.keyCode===a.default.VK_H||e.keyCode==a.default.VK_4||e.keyCode==a.default.VK_LEFT?t(-1,0):e.keyCode===a.default.VK_L||e.keyCode==a.default.VK_6||e.keyCode==a.default.VK_RIGHT?t(1,0):e.keyCode===a.default.VK_K||e.keyCode==a.default.VK_8||e.keyCode==a.default.VK_UP?t(0,-1):e.keyCode===a.default.VK_J||e.keyCode==a.default.VK_2||e.keyCode==a.default.VK_DOWN?t(0,1):e.keyCode===a.default.VK_Y||e.keyCode==a.default.VK_7?t(-1,-1):e.keyCode===a.default.VK_U||e.keyCode==a.default.VK_9?t(1,-1):e.keyCode===a.default.VK_B||e.keyCode==a.default.VK_1?t(-1,1):e.keyCode!==a.default.VK_N&&e.keyCode!=a.default.VK_3||t(1,1),e.keyCode==a.default.VK_I&&this.enterSubscreen(new h.default(this.player.inventory,this))}}},{key:\"enterSubscreen\",value:function(e){this.subscreen=e,this.game.refresh()}},{key:\"exitSubscreen\",value:function(){this.subscreen=null,this.game.refresh()}},{key:\"render\",value:function(t){var r=t.playerStatusDisplay,i=t.getDisplay(),n=this.level.getMap();r.render({name:this.player.name,hp:40,maxHp:40});var s=this.level.getItems();if(s[this.player.getX()+\",\"+this.player.getY()]){var u=s[this.player.getX()+\",\"+this.player.getY()];this.player.addItem(u)?(this.level.removeItem(u),this.game.messageDisplay.add(\"you pick up \"+u.describeA()),console.log(\"you pick up \"+u.describeA())):(this.game.messageDisplay.add(\"you see \"+u.describeA()),console.log(\"you see \"+u.describeA()))}var o=t.getScreenWidth(),d=t.getScreenHeight(),h=Math.max(0,this.player.getX()-o/2);h=Math.min(h,this.level.width-o);var y=Math.max(0,this.player.getY()-d/2);y=Math.min(y,this.level.height-d);var g=new a.default.FOV.PreciseShadowcasting(function(e,t){return!!n.getTile(e,t)&&!n.getTile(e,t).blocksLight}),c={},f=this.level.exploredTiles;g.compute(this.player.getX(),this.player.getY(),10,function(e,t,r,a){c[e+\",\"+t]=!0,f[e+\",\"+t]=!0});for(var p=h;p<h+o;p++)for(var v=y;v<y+d;v++){var m=n.getTile(p,v);c[p+\",\"+v]?i.draw(p-h,v-y,m.getChar(),m.getFg(),m.getBg()):this.level.exploredTiles[p+\",\"+v]&&i.draw(p-h,v-y,m.getChar(),l.default.darkBlue,l.default.black)}Object.keys(s).forEach(function(t){var r=t.split(\",\"),a=e(r,2),l=a[0],n=a[1],u=s[t];c[l+\",\"+n]&&i.draw(parseInt(l)-h,parseInt(n)-y,u.getChar(),u.getFg(),u.getBg())});var k=this.level.getEntities();Object.values(k).forEach(function(e){c[e.getX()+\",\"+e.getY()]&&i.draw(e.getX()-h,e.getY()-y,e.getChar(),e.getFg(),e.getBg())}),i.draw(this.player.getX()-h,this.player.getY()-y,this.player.getChar(),this.player.getFg(),this.player.getBg()),this.subscreen&&this.subscreen.render(t)}}]),r}();exports.default=v;"},"hash":"93c03fcd702e329fa9f29acbc6a75511","cacheData":{"env":{}}}